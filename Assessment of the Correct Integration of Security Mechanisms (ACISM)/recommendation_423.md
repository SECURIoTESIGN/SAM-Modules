# Cross-Site Request Forgery (CSRF)

Cross-Site Request Forgery (CSRF) is a type of attack that induces an authenticated user to perform unwanted actions on a web application. An attacker can trick users of a web application into performing acts of the attacker's choosing using social engineering techniques (such as sending a link via email or chat).

## Owasp ZAP

OWASP ZAP (short for Zed Attack Proxy) is an open-source web application security scanner. ZAP can be defined as a “man-in-the-middle proxy.” It stands between the tester’s browser and the web application so that it can intercept and inspect messages sent between browser and web application, modify the contents if needed, and then forward those packets on to the destination. It can be used as a stand-alone application, and as a daemon process. This scanner claims to test against Path Transversal Vulnerability.

To install and run this scanner the user needs to go to https://www.zaproxy.org/download/ and select the system in which this tool will be installed. This scanner requires Java 8 +.

After installation the application will ask the user if the tester wants to persist the ZAP session. By default, ZAP sessions are always recorded to disk in a HSQLDB database with a default name and location. If you do not persist the session, those files are deleted when you exit ZAP.

To test against CSRF only needed to do the following:

* Start ZAP;
* In the "Sites" tab insert the URL of the SUT; 
* In the SUT create a POST request;
* The request created will appear in the "Request" tab of ZAP, if "csrf-token = SecurityIsDisabled" it is already a signal that the SUT is not protected against CSRF attacks ;
* In the "Sites" tab navigate inside the folder created fot the SUT until you find the post request;
* Right click on the request and choose “Generate anti-CSRF test FORM.”
* A new tab is opened with a CSRF proof of concept. It contains the POST parameters and values from the request. The values can be adjusted by the tester.
* Finally in the opened tab click in the button "Submit".

If the system is vulnerable to CSRF the information present in the tab generated by ZAP will be inserted in the system.

## Burp Suite

Burp Suite is software developed in Java by PortSwigger, to perform security tests on web applications.The Burp Suite is divided into several components such has: Burp Proxy, Burp Spider, Burp Scanner, Burp Intruder, Burp Repeater. etc.
To download this tool the user needs to access https://portswigger.net/burp/communitydownload and download the program to their respective system.


To begin the testing with this tool the tester needs to config their browser's proxy configuration to "localhost" in port 8080.


To test the SUT the tester needs:

* Open the burp suite, go to the "Proxy" tab, click on "Intercept" and press the button "Intercept is off";
* Go to the browser and open the web page to be tested;
* Ensure you are authenticated to the web application you are testing.
* Alter the value in the field/s you wish to change;
* Return to the "Proxy" tab, select intersect and then click on "Intercept is on";
* Submit the request;
* In the "Proxy" tab, right click on the raw request to bring up the context menu;
* Go to the "Engagement tools" options and click "Generate CSRF PoC";
* In the "CSRF PoC generator" window you should alter the value of the user supplied input.
* Click in the "Copy HTML" button;
* Open a text editor, paste the copied HTML and save the file as a HTML file.
* In the Proxy "Intercept" tab, ensure "Intercept is off".
* Log back in to the application with another account;
* Open the HTML file in the same browser (You will need to submit the request manually or it may be submitted automatically depending on the CSRF PoC options);

If the SUT is vulnerable to CSRF the information has been successfully changed.


