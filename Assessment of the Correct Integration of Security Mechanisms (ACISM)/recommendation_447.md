# Replay Attack

This attack occurs when the attacker analyses the traffic and keeps
a copy of it so that he/she can use it in a different context in order to control the device.

To test against this type of attack the user simply needs to perform a MitM attack successfully, save the packets captured and resend the packets to the server. If the packets are accepted and the communication is successful the SUT is not protected against this type of attacks.

## Tcpreplay

Tcpreplay is a suite of free Open Source utilities for editing and replaying previously captured network traffic.

To install this tool the user needs to insert:

``` bash
    sudo apt install tcpreplay
```

If the captured packet was not from a communication to the system you want to test it is needed to change the destination ip, MAC and checksum from the packet by doing the following:

```bash
tcprewrite --infile=[File with captured packets] --outfile=[output file] --dstipmap=[destination IP] --enet-dmac=[destination MAC] --fixcsum

```


To replay the captured packets the tester needs to write the following in the terminal:

``` bash
    tcpreplay -i eth0 [File with captured packets]
```

## Wireshark 

Wireshark is one of the most used network protocol analyzer with this tool it is possible to observe the the traffic generated by the testing done with the tools mentioned above. This tool is only available to Windows and MacOS.

To install this tool the user only need to access https://www.wireshark.org/ and click the link to download and install de system.
